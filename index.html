<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formatador de Contatos Google</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üì± Formatador de Contatos Google</h1>
            <p>Fa√ßa upload da sua planilha CSV do Google Contacts e baixe ela formatada para n√∫meros brasileiros</p>
        </header>

        <main>
            <div class="config-section">
                <h3>‚öôÔ∏è Configura√ß√µes</h3>
                <div class="config-inputs">
                    <div class="input-group">
                        <label for="defaultDDD">DDD Padr√£o:</label>
                        <input type="text" id="defaultDDD" value="19" maxlength="2" placeholder="19">
                        <span class="input-help">Para n√∫meros incompletos (ex: 99887-7665)</span>
                    </div>
                    <div class="input-group">
                        <label for="defaultName">Nome Padr√£o:</label>
                        <input type="text" id="defaultName" value="Cliente" maxlength="30" placeholder="Cliente">
                        <span class="input-help">Para contatos sem nome v√°lido</span>
                    </div>
                </div>
            </div>

            <div class="upload-section">
                <div class="upload-area" id="uploadArea">
                    <div class="upload-icon">üìÑ</div>
                    <h3>Arraste seu arquivo CSV aqui</h3>
                    <p>ou clique para selecionar</p>
                    <input type="file" id="fileInput" accept=".csv" hidden>
                </div>

                <div class="file-info" id="fileInfo" style="display: none;">
                    <div class="file-details">
                        <span class="file-name" id="fileName"></span>
                        <span class="file-size" id="fileSize"></span>
                    </div>
                    <button class="btn-remove" id="removeFile">üóëÔ∏è</button>
                </div>
            </div>

            <div class="processing-section" id="processingSection" style="display: none;">
                <h3>Processando arquivo...</h3>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="processing-info" id="processingInfo">
                    <p>Analisando estrutura do arquivo...</p>
                </div>
            </div>

            <div class="results-section" id="resultsSection" style="display: none;">
                <h3>‚úÖ Processamento Conclu√≠do!</h3>
                <div class="stats">
                    <div class="stat-item">
                        <span class="stat-number" id="identifiedContacts">0</span>
                        <span class="stat-label">Contatos Identificados</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="totalContacts">0</span>
                        <span class="stat-label">Contatos V√°lidos</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="removedContacts">0</span>
                        <span class="stat-label">Contatos Removidos</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="defaultNamesUsed">0</span>
                        <span class="stat-label">Nomes Padr√£o Usados</span>
                    </div>
                </div>

                <div class="download-area">
                    <button class="btn-download" id="downloadBtn">
                        üì• Baixar Arquivo Formatado
                    </button>
                    <p class="download-note">Arquivo limpo e formatado para padr√µes brasileiros</p>
                </div>

                <button class="btn-toggle-debug" id="toggleDebug" style="display: none;">üîç Ver Itens Removidos</button>

                <div class="debug-section" id="debugSection" style="display: none;">
                    <h4>üìã Debug - Itens Removidos</h4>

                    <div class="debug-subsection">
                        <h5>üìû N√∫meros Removidos</h5>
                        <div class="removed-list" id="removedNumbersList"></div>
                    </div>

                    <div class="debug-subsection">
                        <h5>üë§ Nomes Removidos</h5>
                        <div class="removed-list" id="removedNamesList"></div>
                    </div>
                </div>

                <button class="btn-new" id="newFileBtn">üîÑ Processar Novo Arquivo</button>

                <div class="whatsapp-info" id="whatsappInfo" style="display: none;">
                    <button class="btn-whatsapp" id="validateWhatsappBtn">üì± Validar WhatsApp</button>
                    <p class="api-evolution-note">‚ÑπÔ∏è <strong>Necessita API Evolution para validar WhatsApp</strong></p>
                </div>

                <div class="whatsapp-config" id="whatsappConfig" style="display: none;">
                    <h4>üì± Configura√ß√£o da API Evolution</h4>
                    <div class="config-inputs">
                        <div class="input-group">
                            <label for="serverUrl">Server URL:</label>
                            <input type="text" id="serverUrl" placeholder="https://your-server.com">
                            <span class="input-help">URL do servidor da API WhatsApp</span>
                        </div>
                        <div class="input-group">
                            <label for="instanceId">Instance ID:</label>
                            <input type="text" id="instanceId" placeholder="instance123">
                            <span class="input-help">ID da inst√¢ncia WhatsApp</span>
                        </div>
                        <div class="input-group">
                            <label for="apiKey">API Key:</label>
                            <input type="password" id="apiKey" placeholder="sua-api-key">
                            <span class="input-help">Chave da API (mantida segura)</span>
                        </div>
                        <div class="input-group">
                            <label for="batchSize">Lote (n√∫meros por vez):</label>
                            <input type="number" id="batchSize" value="50" min="1" max="1000">
                            <span class="input-help">Quantos n√∫meros validar por chamada</span>
                        </div>
                    </div>

                    <div class="test-connection" id="testConnection">
                        <button class="btn-test" id="testApiBtn" style="display: none;">üîå Validar Dados</button>
                        <div class="connection-status" id="connectionStatus" style="display: none;"></div>
                    </div>

                    <div class="start-validation" id="startValidation" style="display: none;">
                        <button class="btn-start-validation" id="startValidationBtn">üöÄ Iniciar Valida√ß√£o WhatsApp</button>
                        <p class="validation-note">Validar√° todos os n√∫meros da planilha processada</p>
                    </div>

                    <div class="api-evolution-cta">
                        <p class="cta-text">üöÄ <strong>N√£o possui API Evolution?</strong></p>
                        <a href="https://whats-evolution-v2.vercel.app/" target="_blank" class="btn-cta">
                            ‚ö° Criar Minha API Gr√°tis (7 dias)
                        </a>
                        <p class="cta-benefits">‚úÖ 7 dias gr√°tis ‚Ä¢ ‚úÖ Sem cart√£o de cr√©dito ‚Ä¢ ‚úÖ Ativa√ß√£o instant√¢nea</p>
                    </div>
                </div>

                <div class="whatsapp-validation" id="whatsappValidation" style="display: none;">
                    <h3>üì± Valida√ß√£o WhatsApp</h3>
                    <div class="validation-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" id="whatsappProgressFill"></div>
                        </div>
                        <div class="validation-info" id="whatsappValidationInfo">
                            <p>Preparando valida√ß√£o...</p>
                        </div>
                    </div>
                    <div class="validation-stats" id="whatsappStats" style="display: none;">
                        <div class="stat-item">
                            <span class="stat-number" id="validWhatsapp">0</span>
                            <span class="stat-label">WhatsApp V√°lidos</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number" id="invalidWhatsapp">0</span>
                            <span class="stat-label">WhatsApp Inv√°lidos</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number" id="errorWhatsapp">0</span>
                            <span class="stat-label">Erros de Valida√ß√£o</span>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <footer>
            <div class="features">
                <h4>O que este sistema faz:</h4>
                <ul>
                    <li>‚úÖ Formata n√∫meros brasileiros (padr√£o: 5511999887766)</li>
                    <li>‚úÖ Completa n√∫meros incompletos com DDD configur√°vel</li>
                    <li>‚úÖ Suporta m√∫ltiplos n√∫meros por contato (separados por :::)</li>
                    <li>‚úÖ Remove zero inicial de n√∫meros (019 ‚Üí 19)</li>
                    <li>‚úÖ Usa nome padr√£o para contatos sem nome v√°lido</li>
                    <li>‚úÖ Valida DDDs brasileiros (11-99)</li>
                    <li>‚úÖ Valida√ß√£o WhatsApp via API (opcional)</li>
                    <li>‚úÖ Processamento em lotes configur√°vel</li>
                    <li>‚úÖ Debug detalhado com n√∫meros e nomes removidos</li>
                    <li>‚úÖ Mant√©m compatibilidade com Google Contacts</li>
                </ul>
            </div>
        </footer>
    </div>

    <script src="script.js"></script>
</body>
</html>